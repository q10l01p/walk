# 模型恢复训练
参考教程：https://blog.csdn.net/weixin_44061195/article/details/132830367
- 参数设置
    ```python
    class RunnerArgs(PrefixProto, cli=False):
        ...
        
        # 指示是否从之前的运行中恢复
        resume = True
        # 要加载的运行编号，-1表示最后一次运行
        load_run = -1  
        # 要恢复的模型的检查点编号，-1表示最后保存的模型
        checkpoint = -1  
        # 需要恢复的模型的标签或路径
        label = "gait-conditioned-agility/2023-05-18/train" 
        # 根据给定的标签搜索到的目录列表
        dirs = glob.glob(f"../runs/{label}/*")
        # 从搜索到的目录中选出的用于恢复的日志目录
        logdir = sorted(dirs)[0]
        # 实际用于模型恢复的路径
        resume_path = logdir[:]  
    ```
- 恢复模型
    ```python
    if RunnerArgs.resume:
        # 导入ML_Logger用于数据加载，这里使用的是本地地址
        from ml_logger import ML_Logger
        # 使用指定的root和prefix初始化ML_Logger
        loader = ML_Logger(root="http://127.0.0.1:8081", prefix=RunnerArgs.resume_path)
        # 使用torch.load直接从指定路径加载模型权重
        weights = torch.load(RunnerArgs.resume_path + "/checkpoints/ac_weights_last.pt")
        # 将加载的权重应用到actor_critic模型
        actor_critic.load_state_dict(state_dict=weights)
    
        # 如果环境支持curricula并且设置了恢复curriculum
        if hasattr(self.env, "curricula") and RunnerArgs.resume_curriculum:
            # 使用pickle从指定路径加载curriculum状态
            f = open(RunnerArgs.resume_path + '/curriculum/distribution.pkl','rb')
            distributions = pickle.load(f)
            # 获取最后的distribution状态
            distribution_last = distributions["distribution"]
            # 从distribution中提取gait名称
            gait_names = [key[8:] if key.startswith("weights_") else None for key in distribution_last.keys()]
            # 更新环境中每个gait的weights
            for gait_id, gait_name in enumerate(self.env.category_names):
                self.env.curricula[gait_id].weights = distribution_last[f"weights_{gait_name}"]
                # 打印gait名称，用于调试
                print(gait_name)
    ```